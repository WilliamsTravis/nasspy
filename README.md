# nasspy
Python wrappers for the National Agricultural Statistics Service's Quick Stats API.

To use:

    1) Create an api object: 
        api = NASS_API(<your nass key as a string>)
  
    2) Get a list of available parameters with api.all_parameters
    
    3) Get a list of the definitions of these parameters using
        api.what_parameters, api.where_parameters, and api.when_parameters

    4) Get a list of input options for any one parameter using
        api.get_parameter_options('parameter')

    5) Build a query as a list of strings like this:
        ['<parameter1>=<input1>', '<parameter2>=<input2>', ...]

    6) Filter each query by appending an operator to each string element:
        '<parameter><operator>=<input>'

    7) For count use the query list as the argument in api.get_query_count:
        data = api.get_query_count(query)

    8) For the data itself use the query list in api.get_query:
        data = api.get_query(query)

    9) Examples:
  
        Retrieve weekly corn yields from Montana since 1980:
            query = ['state_name=MONTANA', 'commodity_desc=CORN', 'year__GE=1980', 'freq_desc=WEEKLY']
            data = api.get_query(query)
```python
from functions import NASS_API
        
# 1) Create api object
api = NASS_API()

# 2) Check available 'what', 'when', and 'where' parameters
whats = api.what_parameters
wheres = api.where_parameters
whens = api.when_paramaters

# 3) For any one parameter, print out options
api.get_parameter_options("commodity_desc")  # A 'What' option
#> ['AG LAND',
 'AG SERVICES',
 'AG SERVICES & RENT',
 'ALCOHOL COPRODUCTS',
 'ALMONDS',
 'ALPACAS',
 'AMARANTH',
 'ANIMAL PRODUCTS, OTHER',
 'ANIMAL SECTOR',
 'ANIMAL TOTALS',
 'ANIMALS, OTHER',
 'APPLES',
 'APRICOTS',
 'AQUACULTURE TOTALS',
 'AQUACULTURE, OTHER',
 'AQUATIC PLANTS',
 'ARONIA BERRIES',
 'ARTICHOKES',
 'ASPARAGUS',
 'ASSETS',
 'AUTOS',
 'AVOCADOS',
 'BAITFISH',
 'BANANAS',
 'BAREROOT HERBACEOUS PERENNIALS',
 'BARLEY',
 'BEANS',
 'BEDDING PLANT TOTALS',
 'BEDDING PLANTS, ANNUAL',
 'BEDDING PLANTS, HERBACEOUS PERENNIAL',
 'BEEF',
 'BEESWAX',
 'BEETS',
 'BERRIES, OTHER',
 'BERRY TOTALS',
 'BISON',
 'BLACKBERRIES',
 'BLUEBERRIES',
 'BOYSENBERRIES',
 'BROCCOLI',
 'BRUSSELS SPROUTS',
 'BUCKWHEAT',
 'BUILDING MATERIALS',
 'BULBS & CORMS & RHIZOMES & TUBERS',
 'BUSINESS ACTIVITY',
 'BUTTER',
 'BUTTERMILK',
 'CABBAGE',
 'CACTI & SUCCULENTS',
 'CAKE & MEAL',
 'CAMELINA',
 'CANEBERRIES',
 'CANOLA',
 'CARROTS',
 'CATTLE',
 'CAULIFLOWER',
 'CCC LOANS',
 'CELERY',
 'CHEESE',
 'CHEMICAL TOTALS',
 'CHEMICALS, OTHER',
 'CHERIMOYAS',
 'CHERRIES',
 'CHESTNUTS',
 'CHICKENS',
 'CHICKPEAS',
 'CHICORY',
 'CHUKARS',
 'CITRUS TOTALS',
 'CITRUS, OTHER',
 'COFFEE',
 'COMMODITY TOTALS',
 'COMPUTERS',
 'CONSUMER PRICE INDEX',
 'CORN',
 'COTTON',
 'CRAMBE',
 'CRANBERRIES',
 'CREAM',
 'CROP SECTOR',
 'CROP TOTALS',
 'CROPS, OTHER',
 'CRUDE PINE GUM',
 'CRUSTACEANS',
 'CUCUMBERS',
 'CURRANTS',
 'CUT CHRISTMAS TREES',
 'CUT CHRISTMAS TREES & SHORT TERM WOODY CROPS',
 'CUT CULTIVATED GREENS',
 'CUT FLOWERS',
 'CUT FLOWERS & CUT CULTIVATED GREENS',
 'DAIKON',
 'DAIRY PRODUCT TOTALS',
 'DAIRY PRODUCTS, OTHER',
 'DATES',
 'DEBT',
 'DECIDUOUS FLOWERING TREES',
 'DECIDUOUS SHADE TREES',
 'DECIDUOUS SHRUBS',
 'DEER',
 'DEPRECIATION',
 'DILL',
 'DUCKS',
 'EGGPLANT',
 'EGGS',
 'ELDERBERRIES',
 'ELK',
 'EMMER & SPELT',
 'EMUS',
 'ENERGY',
 'EQUINE',
 'ESCAROLE & ENDIVE',
 'EVERGREENS, BROADLEAF',
 'EVERGREENS, CONIFEROUS',
 'EXPENSE TOTALS',
 'EXPENSES, OTHER',
 'FACILITIES & EQUIPMENT',
 'FARM OPERATIONS',
 'FARM SECTOR',
 'FEED',
 'FEED GRAINS',
 'FEED GRAINS & HAY',
 'FEED PRICE RATIO',
 'FERTILIZER & CHEMICAL TOTALS',
 'FERTILIZER TOTALS',
 'FERTILIZER, MIXED',
 'FERTILIZER, OTHER',
 'FIELD CROP TOTALS',
 'FIELD CROPS, OTHER',
 'FIELDWORK',
 'FIGS',
 'FLAXSEED',
 'FLORICULTURE TOTALS',
 'FLORICULTURE, OTHER',
 'FLOUR',
 'FLOWER SEEDS',
 'FLOWERING PLANTS, POTTED',
 'FOLIAGE PLANTS',
 'FOOD COMMODITIES',
 'FOOD CROP TOTALS',
 'FOOD CROP, OTHER',
 'FOOD FISH',
 'FOOD GRAINS',
 'FRUIT & NUT PLANTS',
 'FRUIT & TREE NUT TOTALS',
 'FRUIT & TREE NUTS, OTHER',
 'FRUIT TOTALS',
 'FRUIT, OTHER',
 'FUELS',
 'FUMIGANTS',
 'FUNGICIDES',
 'FUNGICIDES & OTHER',
 'GARLIC',
 'GEESE',
 'GINGER ROOT',
 'GINSENG',
 'GOATS',
 'GOOSEBERRIES',
 'GOVT PROGRAMS',
 'GRAIN',
 'GRAIN STORAGE CAPACITY',
 'GRAPEFRUIT',
 'GRAPES',
 'GRASSES',
 'GRASSES & LEGUMES TOTALS',
 'GRASSES & LEGUMES, OTHER',
 'GREASE',
 'GREENS',
 'GROWING MEDIA',
 'GUAR',
 'GUAVAS',
 'GUINEAS',
 'HAY',
 'HAY & HAYLAGE',
 'HAYLAGE',
 'HAZELNUTS',
 'HERBICIDES',
 'HERBS',
 'HOGS',
 'HONEY',
 'HOPS',
 'HORSERADISH',
 'HORTICULTURE TOTALS',
 'HORTICULTURE, OTHER',
 'ICE CREAM',
 'IMPROVEMENT & CONSTRUCTION',
 'INCOME, FARM-RELATED',
 'INCOME, NET CASH FARM',
 'INSECTICIDES',
 'INTEREST',
 'INTERNET',
 'JOJOBA',
 'K-EARLY CITRUS',
 'KIWIFRUIT',
 'KUMQUATS',
 'LABOR',
 'LAMB & MUTTON',
 'LAND AREA',
 'LANDLORDS',
 'LARD',
 'LEGUMES',
 'LEMONS',
 'LENTILS',
 'LETTUCE',
 'LIMES',
 'LIVESTOCK TOTALS',
 'LLAMAS',
 'LOGANBERRIES',
 'LOTUS ROOT',
 'MACADAMIAS',
 'MACHINERY',
 'MACHINERY TOTALS',
 'MACHINERY, OTHER',
 'MANGOES',
 'MAPLE SYRUP',
 'MEAL',
 'MELLORINE',
 'MELONS',
 'MILK',
 'MILLET',
 'MILLFEED',
 'MINK',
 'MINT',
 'MISCANTHUS',
 'MOHAIR',
 'MOLLUSKS',
 'MUSHROOM SPAWN',
 'MUSHROOMS',
 'MUSTARD',
 'NECTARINES',
 'NITROGEN',
 'NON-CITRUS FRUIT & TREE NUTS TOTALS',
 'NON-CITRUS TOTALS',
 'NON-CITRUS, OTHER',
 'NONFARM SECTOR',
 'NURSERY & FLORICULTURE TOTALS',
 'NURSERY TOTALS',
 'NURSERY, OTHER',
 'OATS',
 'OIL',
 'OIL-BEARING CROPS',
 'OKRA',
 'OLIVES',
 'ONIONS',
 'OPERATORS',
 'OPERATORS, FIRST FOUR OPERATORS',
 'OPERATORS, PRINCIPAL',
 'OPERATORS, SECOND',
 'OPERATORS, THIRD',
 'ORANGES',
 'ORCHARDS',
 'ORNAMENTAL FISH',
 'ORNAMENTAL GRASSES',
 'OSTRICHES',
 'PACKING FACILITY',
 'PALMS',
 'PAPAYAS',
 'PARSLEY',
 'PARTRIDGES',
 'PASSION FRUIT',
 'PASTURELAND',
 'PEACHES',
 'PEACHES & NECTARINES',
 'PEAFOWL',
 'PEANUTS',
 'PEARS',
 'PEAS',
 'PEAS & CARROTS',
 'PEAS & LENTILS',
 'PECANS',
 'PEPPERS',
 'PERSIMMONS',
 'PHEASANTS',
 'PHOSPHATE',
 'PICKLES',
 'PIGEONS & SQUAB',
 'PIMIENTOS',
 'PINEAPPLES',
 'PISTACHIOS',
 'PITW',
 'PLUM-APRICOT HYBRIDS',
 'PLUMS',
 'PLUMS & PRUNES',
 'POMEGRANATES',
 'POPCORN',
 'PORK',
 'POTASH',
 'POTASH & PHOSPHATE',
 'POTATOES',
 'POTATOES & DRY BEANS',
 'POULTRY BY-PRODUCT MEALS',
 'POULTRY FATS',
 'POULTRY TOTALS',
 'POULTRY, OTHER',
 'PPITW',
 'PRACTICES',
 'PRICE INDEX RATIO',
 'PRODUCERS',
 'PRODUCERS, (EXCL PRINCIPAL)',
 'PRODUCERS, PRIMARY',
 'PRODUCERS, PRINCIPAL',
 'PRODUCTION ITEMS',
 'PRODUCTION ITEMS & CONSUMER PRICE INDEX',
 'PROPAGATIVE MATERIAL',
 'PRUNES',
 'PUMPKINS',
 'PUMPS',
 'QUAIL',
 'RABBITS',
 'RADISHES',
 'RAPESEED',
 'RASPBERRIES',
 'RED MEAT',
 'RENT',
 'REPAIRS',
 'RETURNS & ALLOWANCES',
 'RHEAS',
 'RHUBARB',
 'RICE',
 'ROW CROPS',
 'RYE',
 'SAFFLOWER',
 'SEEDS',
 'SEEDS & PLANTS TOTALS',
 'SELF PROPELLED',
 'SESAME',
 'SHEEP',
 'SHEEP & GOATS TOTALS',
 'SHERBET',
 'SHORT TERM WOODY CROPS',
 'SMALL GRAINS',
 'SNOW',
 'SOD',
 'SOIL',
 'SORGHUM',
 'SOYBEANS',
 'SPECIALTY ANIMAL TOTALS',
 'SPECIALTY ANIMALS, OTHER',
 'SPINACH',
 'SPORT FISH',
 'SQUASH',
 'STRAWBERRIES',
 'SUGARBEETS',
 'SUGARCANE',
 'SUNFLOWER',
 'SUPPLIES',
 'SUPPLIES & REPAIRS',
 'SWEET CORN',
 'SWEET POTATOES',
 'SWEET RICE',
 'SWITCHGRASS',
 'TALLOW',
 'TANGELOS',
 'TANGERINES',
 'TARO',
 'TAXES',
 'TEMPLES',
 'TENANTS',
 'TOBACCO',
 'TOMATOES',
 'TRACTORS',
 'TRACTORS & SELF PROPELLED',
 'TRANSPLANTS',
 'TREE NUT TOTALS',
 'TREE NUTS, OTHER',
 'TRITICALE',
 'TRUCKS',
 'TRUCKS & AUTOS',
 'TURKEYS',
 'TURNIPS',
 'VEAL',
 'VEGETABLE SEEDS',
 'VEGETABLE TOTALS',
 'VEGETABLES, MIXED',
 'VEGETABLES, OTHER',
 'WALNUTS',
 'WATER',
 'WATER ICES',
 'WATERCRESS',
 'WELLS',
 'WHEAT',
 'WHEY',
 'WILD RICE',
 'WOODY ORNAMENTALS & VINES, OTHER',
 'WOOL',
 'YOGURT']
#api.get_parameter_options("state_name")  # A 'Where' option
#api.get_parameter_options("agg_level_desc")  # Another 'Where' option
#api.get_parameter_options("reference_period_desc")  # A 'when' option
#api.get_parameter_options("year")  # A more straightforward 'When' option

# 3) To query with a numeric parameter, one of these operators must be used
print(api.operator_options)
#>          CALL   FAMILIAR ANALOG                  DESCRIPTION
#> 0        __LE                <=       Less than or equal to.
#> 1        __LT                 <                   Less than.
#> 2        __GT                 >                Greater than.
#> 3        __GE                >=    Greater than or equal to.
#> 4        __NE                !=                Not equal to.
#> 5      __LIKE              like              Pattern is in. 
#> 6  __NOT_LIKE          not like           Pattern is not in.

# For instance, to retrieve data for years since 1980 the 'When' query becomes:
"year__GE=1980"
#> 'year__GE=1980'

# 4) Use these to build a list of queries (["<param><operator>=<option>", ...])
query = ['state_name=IOWA', 'commodity_desc=CORN',  'year__GE=1950',
         'freq_desc=WEEKLY']

# 5) And run that query to retrieve a pandas data frame
data = api.get_query(query)

# Unfortunately, unavailable queries are interpreted as bad requests:
query = ['state_name=IOWA', 'commodity_desc=CORN',  'year__GE=2014',
         'freq_desc=WEEKLY', 'agg_level_desc=COUNTY']
api.get_query(query)
#> {'error': ['bad request - invalid query']}
```

<sup>Created on 2019-09-04 by the [reprexpy package](https://github.com/crew102/reprexpy)</sup>
